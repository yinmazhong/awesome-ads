# 广告黑产攻防：防守方落地清单（检测 / 防护 / 处置）

本篇是“防守方视角”的工程清单，目标是帮助你把黑产风险变成可执行的**监控指标、拦截策略、复盘流程**。

你提出的交付物诉求是“针对性的防守监控告警策略方案”。因此本文会按常见类型输出：

- **脱敏示例**：你在数据上会看到的“现象长什么样”（不提供可复现的攻击实现细节）
- **被发现的过程**：信号定义、告警规则、排查路径、证据留存
- **处罚/处置结果**：止血动作、业务侧拦截、媒体/渠道侧沟通与索赔、内部追责

---

## 1. 先做边界：你要防的是什么？

按业务目标分三类（对应不同团队 KPI）：

- **计费防护**：减少无效曝光/点击/转化导致的预算浪费。
- **训练防护**：避免虚假信号污染投放模型（即便没直接浪费钱，也会拉低长期效果）。
- **数据可信**：让归因、报表、ROI 分析“能解释、能复现”。

---

## 2. 必备数据采集（没有这些就谈不上反作弊）

### 2.1 事件最小字段集（Web/PWA 也适用）

- **时间**：事件时间戳（毫秒级最好）
- **主体**：campaign/adset/ad/creative id（能定位到素材/投放单元）
- **来源**：referrer、utm、click_id（若平台提供）
- **设备与网络**：IP、UA、设备指纹/会话标识（注意合规）
- **链路**：落地页 URL、跳转次数、首跳与最终页
- **业务关键字段**：注册方式、支付方式、订单金额、币种

> 原则：字段不是越多越好，但要能支持“聚合看异常 + 单条追溯复盘”。

---

## 2.2 证据留存（让处罚与索赔“站得住”）

- **样本池**：每个告警至少保存 `N` 条（或 `N%`）原始样本（脱敏后）
- **影响评估**：影响预算、影响转化、影响 ROAS、影响训练数据量
- **可复现口径**：告警规则版本、时间窗口、基线对照组
- **链路证明**：从“投放侧标识（campaign/ad/creative）→ 访问 → 转化 → 结算/回传”的完整链路

---

## 3. 告警分级（统一语言，避免“发现了但没人动”）

建议用统一的严重等级来驱动自动化动作与升级路径：

- **P3（观察）**：轻微偏离基线，有业务解释空间；先记录与持续观察
- **P2（风险）**：偏离显著，可能造成预算浪费或数据污染；触发降权/限速/加严校验
- **P1（高危）**：高度疑似作弊，已造成明显损失或污染；触发隔离/暂停/黑名单
- **P0（紧急）**：大规模、持续性、可快速放大损失；触发全局止血与跨团队升级

每个告警建议固定输出：`告警类型`、`严重等级`、`影响范围`、`建议动作`、`证据链接`、`责任人`。

---

## 4. 分类型的监控告警策略（含示例 / 发现过程 / 处罚结果）

本节按“监控对象”组织，每类都给出可直接写进方案的结构。阈值请以你的历史基线、国家/平台差异与产品漏斗为准。

### 4.1 流量质量异常（疑似脚本流量 / 设备农场 / 异常媒体位）

#### 脱敏示例（现象）

- 某一小段时间内 `click` 激增，但 `landing_page_view` 不成比例
- `IP/ASN`、`UA`、`屏幕分辨率/语言` 等分布突然高度集中
- 页面停留时间、滚动、点击等交互信号长期接近 0

#### 被发现的过程（信号 → 规则 → 排查）

- **信号定义**：
  - `click -> lpv` 转化率、`lpv -> register` 转化率
  - `IP/ASN topN 占比`、`UA topN 占比`、`同会话内跳转次数分布`
  - 行为信号：`停留时长分布`、`交互事件覆盖率`
- **告警规则（示意）**：
  - 当 `click` 占比上涨且 `click -> lpv` 显著低于基线，触发 P2
  - 当 `ASN/UA topN` 占比高于基线且持续多个窗口，触发 P1
  - 当异常集中发生在单一 `publisher/placement/creative`，优先定位为局部风险
- **排查路径**：
  - 从 `campaign -> adset -> ad -> creative -> placement/publisher` 逐级下钻
  - 抽样核对访问链：是否存在异常重定向、异常落地页加载失败、异常地域
  - 对照其他渠道同时间窗：判断是否全局网络/站点故障导致的“假异常”

#### 处罚/处置结果（建议输出到方案）

- **P2**：对可疑 `placement/publisher` 限速、加严校验（如更严格的频控/限次）、观察 24-48h
- **P1**：暂停异常单元、拉黑高风险 `placement/publisher`、将该段流量从核心转化口径与训练口径隔离
- **P0**：全局止血（暂停相关活动或渠道）、启用备用落地页与更强校验、组织战情室复盘
- **对外动作**：向媒体/代理提交证据包（时间窗、样本、影响金额、规则版本），申请无效流量返款/补量

---

### 4.2 转化可信异常（疑似假注册 / 假付费 / 刷单）

#### 脱敏示例（现象）

- `register` 很高，但注册后关键行为（激活/关键页面/下单）极低
- 付费金额/币种分布异常集中，退款率或支付失败率异常
- 同一设备/会话在短时间出现大量“关键转化”（不符合正常节奏）

#### 被发现的过程（信号 → 规则 → 排查）

- **信号定义**：
  - `register -> key_action`、`pay -> retained`、`pay -> refund` 漏斗
  - `转化延迟分布`（从首次访问到转化的时间差）
  - `重复度`：账号特征重复（需合规脱敏）、设备/会话重复、订单特征重复
- **告警规则（示意）**：
  - 当 `register` 上升但 `register -> key_action` 低于基线且持续，触发 P2
  - 当 `pay` 异常且退款/失败显著升高，触发 P1
  - 当关键事件在极短延迟内集中爆发，触发 P1
- **排查路径**：
  - 抽样检查服务端业务记录：注册是否完成验证、订单状态是否真实完成
  - 对照渠道维度：是否集中在某个 `campaign/creative/placement`
  - 检查是否产品/支付故障导致指标失真（例如“付款成功事件重复上报”）

#### 处罚/处置结果

- **止血**：对异常来源降预算/暂停；对高风险用户/会话加严校验（验证码/限频/风控挑战）
- **口径隔离**：将“待确认转化”与“已确认转化”分开统计，未确认的不参与训练与结算口径
- **业务侧处罚**：批量封禁账号、冻结订单、延迟发货/延迟权益发放（视业务形态）
- **对外动作**：按证据包与合同条款对渠道执行扣量/拒付/索赔，并同步更新黑名单与投放白名单策略

---

### 4.3 归因可信异常（疑似归因争抢 / 渠道贡献异常）

#### 脱敏示例（现象）

- 同一产品在短期内某渠道“贡献占比”异常抬升，但用户质量不匹配
- 渠道之间互相“抢单”：同一时间窗多渠道贡献波动剧烈
- 新活动上线后，自然量下降幅度与预期不一致（提示归因口径可能被影响）

#### 被发现的过程（信号 → 规则 → 排查）

- **信号定义**：
  - 渠道贡献：`install/register/pay` 的渠道占比、波动率
  - 质量对齐：渠道维度的 `留存/复访/LTV/退款` 是否与贡献同步
  - `click_id` 覆盖率、异常缺失率（若平台提供）
- **告警规则（示意）**：
  - 当渠道贡献占比上升但质量指标不提升（甚至变差），触发 P2
  - 当多渠道贡献在短窗口剧烈振荡且无法被投放节奏解释，触发 P1
- **排查路径**：
  - 校验归因配置变更：窗口期、优先级、事件映射、去重逻辑
  - 对照 MMP/内部埋点：同一事件在不同系统的数量差与延迟差
  - 抽样核对：从转化事件反查来源链路是否完整、是否存在异常重定向

#### 处罚/处置结果

- **配置止损**：回滚近期归因配置变更；对异常渠道先做口径隔离与“只看已确认事件”
- **投放策略**：收紧该渠道预算与受众，直到质量与贡献一致
- **对外动作**：要求渠道提供流量来源透明度与排查配合；不配合则降级为测试预算或终止合作

---

### 4.4 资产与合规风险（恶意投诉/品牌冒充/数据污染）

#### 脱敏示例（现象）

- 广告/域名/页面被集中投诉导致审核失败率飙升
- 出现疑似仿冒品牌的落地页/素材，造成用户投诉或平台处罚
- Pixel/关键事件质量突然下降，模型效果劣化但站内核心行为未变

#### 被发现的过程（信号 → 规则 → 排查）

- **信号定义**：
  - 审核通过率、拒审原因分布、账号健康度变化
  - 品牌关键词监测（站内/外部反馈）、用户投诉工单与退订/退款异常
  - 事件质量：关键事件缺失率、重复率、参数完整性
- **告警规则（示意）**：
  - 审核失败率或特定拒审原因在短时间显著上升，触发 P1
  - 事件质量指标显著劣化且集中在特定版本/页面，触发 P2
- **排查路径**：
  - 固定化回溯：最近一周的素材/文案/落地页/埋点/发布变更
  - 分离变量：新域名/新页面/新事件先在隔离环境跑小流量
  - 汇总平台侧通知、拒审原因、用户投诉内容以形成证据包

#### 处罚/处置结果

- **止血**：暂停风险素材/页面；启用备用域名与合规模板；收敛投放节奏
- **资产隔离**：核心像素与核心事件不与高风险实验共用，避免污染主链路
- **对外动作**：对平台发起申诉（附证据包与整改项）；对仿冒行为发起品牌保护/投诉流程
- **内部治理**：发布前合规与风控检查卡点；关键变更需要灰度与回滚预案

---

## 5. 防护：常见拦截与降权策略（不伤业务优先）

### 5.1 分层处置策略（推荐）

- **轻度异常**：降权（降低出价/缩预算/降低该受众覆盖）
- **中度异常**：拦截（验证码/二次确认/限频/黑名单）
- **重度异常**：隔离（独立投放组、独立落地页、独立事件口径，避免污染主链路）

### 5.2 转化链路加固（对假转化最有效）

- **关键转化用服务端校验**：例如注册需要邮件/短信验证、付费需要服务端确认订单状态
- **事件去重**：同一订单/同一用户短时间多次上报应去重
- **延迟回传**：对高风险事件先进入“待确认队列”，确认后再计入核心指标（取舍实时性与准确性）

### 5.3 投放侧策略（减少被黑产“吸量”）

- **白名单落地页**：减少跳转链与第三方重定向
- **素材与受众分组隔离**：新素材、新受众先小流量跑质量
- **频控与预算节奏**：避免短时间暴涨触发黑产套利

---

## 6. 处置：发现异常后怎么做（标准作业流程）

- **[定位]** 从 campaign → adset → ad → creative 逐级缩小范围
- **[对比]** 与历史基线/其他渠道做对照（确认是局部异常还是全局问题）
- **[止血]** 先缩预算/暂停异常单元，避免继续污染
- **[证据]** 保留日志、样本、时间窗口、影响金额与影响指标
- **[复盘]** 输出：触发原因、检测信号、拦截策略、后续监控项

---

## 7. 与归因/MMP/平台风控的关系（避免“误把黑产当增长”）

- **归因只解决“是谁带来”的问题**，不解决“是不是人”的问题。
- **反作弊要前置到数据采集与业务校验**，否则你会在报表里看到漂亮的转化，但长期 ROAS 下降。

---

## 8. 你作为个人开发者怎么做（最小版）

- 先实现 3 个报表：
  - `campaign -> CTR/CVR/CPA` 日报
  - `注册 -> 次日回访/关键行为` 日报
  - `IP/UA topN` 异常监控
- 先做 2 个拦截：
  - 注册验证码/限频
  - 服务端订单校验 + 事件去重

做到这一步，你就拥有了“能发现、能止血、能复盘”的最小反作弊能力。
