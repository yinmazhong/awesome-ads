# 搜索广告 (Search Ads)

## 一句话概述

搜索广告是在线广告最成熟、eCPM 最高的广告形式，用户主动搜索表达明确意图，广告通过关键词匹配和竞价排名展示在搜索结果中，是 Google 和百度的核心收入来源。

---

## 搜索广告系统架构

```
用户搜索 Query
      │
      ▼
┌──────────────────────────────────────────────┐
│                搜索广告系统                     │
│                                                │
│  ┌──────────┐  ┌──────────┐  ┌──────────┐    │
│  │ 查询理解  │→│ 广告检索  │→│ 排序与竞价│    │
│  │  (QU)    │  │(Retrieval)│  │(Ranking) │    │
│  └──────────┘  └──────────┘  └──────────┘    │
│       │             │              │          │
│       ▼             ▼              ▼          │
│  意图识别      关键词匹配      质量分×出价    │
│  Query改写     相关性过滤      eCPM排序       │
│  实体识别      广告召回        GSP竞价        │
└──────────────────────────────────────────────┘
      │
      ▼
搜索结果页 (SERP)
  [广告1] [广告2] [自然结果1] [自然结果2] [广告3] ...
```

---

## 搜索广告 vs 信息流广告

| 维度 | 搜索广告 | 信息流广告 |
|------|---------|----------|
| **用户意图** | 主动搜索，意图明确 | 被动浏览，意图模糊 |
| **匹配方式** | 关键词匹配 | 人群定向 |
| **CTR** | 高 (2%–10%) | 中 (1%–3%) |
| **CVR** | 高 | 中 |
| **eCPM** | 最高 | 高 |
| **创意形式** | 文字为主 | 图片/视频为主 |
| **广告主类型** | 各行业 | 效果广告主为主 |
| **核心技术** | 查询理解、相关性 | 用户画像、CTR预估 |

---

## 查询理解 (Query Understanding)

### 意图识别

```
用户搜索 Query → 意图分类

意图类型:
  - 导航意图: "淘宝" → 用户想去淘宝网站
  - 信息意图: "感冒怎么办" → 用户想获取信息
  - 交易意图: "iPhone 16 价格" → 用户有购买意向 ← 广告价值最高
  - 本地意图: "附近的餐厅" → 用户想找本地服务

商业意图强度:
  "买 iPhone 16" → 强商业意图 (高广告价值)
  "iPhone 16 评测" → 中商业意图
  "iPhone 发展历史" → 弱商业意图 (低广告价值)
```

### Query 改写与扩展

```
原始 Query: "北京租房"

改写/扩展:
  - 同义改写: "北京房屋出租"
  - 下位扩展: "北京朝阳区租房", "北京两居室出租"
  - 相关扩展: "北京租房价格", "北京租房平台"
  - 纠错: "北京组房" → "北京租房"

技术:
  - 同义词典
  - Query2Query 模型 (Seq2Seq)
  - BERT 语义改写
  - 大模型 Query 理解
```

### 实体识别 (NER)

```
Query: "北京朝阳区三居室租房 5000以内"

实体识别:
  - 城市: 北京
  - 区域: 朝阳区
  - 户型: 三居室
  - 行为: 租房
  - 价格: 5000以内

用途:
  - 精准匹配广告主的关键词
  - 结构化理解用户需求
  - 触发特定广告模板
```

---

## 关键词体系

### 广告主关键词管理

```
广告账户结构:
  账户 (Account)
    └── 推广计划 (Campaign)
          └── 推广单元 (Ad Group)
                ├── 关键词列表 (Keywords)
                │   ├── "英语培训" (广泛匹配)
                │   ├── "成人英语培训" (短语匹配)
                │   └── [在线英语课程] (精确匹配)
                ├── 否定关键词 (Negative Keywords)
                │   └── "免费" (排除含"免费"的搜索)
                └── 广告创意 (Ad Creatives)
```

### 关键词匹配类型

| 匹配类型 | 符号 | 示例关键词 | 触发 Query | 说明 |
|---------|------|----------|-----------|------|
| **精确匹配** | [关键词] | [红色跑鞋] | 红色跑鞋 | 完全一致 |
| **短语匹配** | "关键词" | "红色跑鞋" | 买红色跑鞋、红色跑鞋推荐 | 包含关键词 |
| **广泛匹配** | 关键词 | 红色跑鞋 | 运动鞋、跑步装备、Nike鞋 | 语义相关 |

```
匹配范围: 精确 ⊂ 短语 ⊂ 广泛

精确匹配: 流量少，精准度高，CPC 低
广泛匹配: 流量大，精准度低，CPC 可能高
```

### 关键词推荐

```
广告主输入种子词 → 系统推荐相关关键词

推荐来源:
  1. 搜索日志挖掘: 用户实际搜索的相关词
  2. 竞品关键词: 同行业广告主使用的词
  3. 语义扩展: 基于 NLP 的语义相关词
  4. 长尾词挖掘: 搜索量小但转化率高的词

示例:
  种子词: "英语培训"
  推荐:
    - "成人英语培训班" (月搜索量 5000, 建议出价 ¥8)
    - "在线英语课程" (月搜索量 3000, 建议出价 ¥6)
    - "英语口语培训" (月搜索量 8000, 建议出价 ¥10)
    - "商务英语培训" (月搜索量 2000, 建议出价 ¥12)
```

---

## 广告相关性 (Relevance)

### 为什么相关性重要？

```
用户搜索 "感冒药" → 展示 "游戏下载" 广告
  → 用户体验差
  → CTR 极低
  → 广告主浪费预算
  → 平台收入下降

相关性是搜索广告的生命线
```

### 相关性计算

```
三层相关性:
  1. Query-关键词 相关性: 用户搜索词与广告主关键词的匹配度
  2. Query-广告 相关性: 用户搜索词与广告创意的相关度
  3. Query-落地页 相关性: 用户搜索词与落地页内容的相关度

技术方案:
  传统: BM25, TF-IDF
  深度学习: DSSM, BERT 语义匹配
  大模型: LLM 相关性判断
```

### DSSM (Deep Structured Semantic Model)

```
架构:
  Query → Embedding → MLP → Query向量
  Ad    → Embedding → MLP → Ad向量
  
  相关性 = cosine(Query向量, Ad向量)

优点:
  - 语义级别匹配，不依赖字面重合
  - 离线计算 Ad 向量，在线只需计算 Query 向量
  - 支持向量检索 (ANN)
```

---

## 质量分 (Quality Score)

### 定义
平台对广告质量的综合评分，影响广告排名和实际扣费。

### 质量分组成

```
Quality Score = f(预期CTR, 广告相关性, 落地页体验)

各因素:
  预期CTR (Expected CTR):
    - 基于历史 CTR 数据
    - 考虑广告位置的影响 (位置归一化)
    - 权重最大

  广告相关性 (Ad Relevance):
    - Query 与广告文案的语义相关度
    - 关键词与广告组的匹配度

  落地页体验 (Landing Page Experience):
    - 页面加载速度
    - 移动端适配
    - 内容与广告的一致性
    - 用户停留时间 / 跳出率

Google Ads 质量分: 1-10 分
百度质量分: 1-10 分 (星级展示)
```

### 质量分对排名和扣费的影响

```
Ad Rank = 出价 × 质量分

示例:
  广告A: 出价 ¥5, 质量分 8 → Ad Rank = 40
  广告B: 出价 ¥8, 质量分 4 → Ad Rank = 32
  广告C: 出价 ¥6, 质量分 6 → Ad Rank = 36

排名: A(40) > C(36) > B(32)

实际扣费 (GSP):
  A 的扣费 = C的AdRank / A的质量分 + ¥0.01
           = 36 / 8 + 0.01 = ¥4.51

结论: 质量分高的广告可以用更低出价获得更好排名
```

---

## 搜索广告排序

### 排序公式

```
传统排序:
  Ad Rank = bid × Quality Score

现代排序 (oCPC):
  Ad Rank = bid × pCTR × pCVR × Quality Score × 1000

多目标排序:
  Ad Rank = α × eCPM + β × 相关性 + γ × 用户体验分
```

### GSP 竞价 (Generalized Second-Price)

```
搜索结果页有多个广告位，每个位置的点击率不同:
  位置1: CTR 衰减系数 1.0
  位置2: CTR 衰减系数 0.7
  位置3: CTR 衰减系数 0.5

GSP 扣费:
  位置 i 的广告扣费 = 位置 i+1 广告的 Ad Rank / 位置 i 广告的质量分 + ¥0.01

示例:
  位置1: 广告A (Ad Rank=40, QS=8) → 扣费 = 36/8 + 0.01 = ¥4.51
  位置2: 广告C (Ad Rank=36, QS=6) → 扣费 = 32/6 + 0.01 = ¥5.34
  位置3: 广告B (Ad Rank=32, QS=4) → 扣费 = 底价
```

---

## 搜索广告创意

### 创意结构

```
┌─────────────────────────────────────────┐
│ 标题1 - 标题2 - 标题3                    │ ← 标题 (最多3个)
│ www.example.com/path                     │ ← 显示URL
│ 描述文案，最多90个字符，突出产品优势和    │ ← 描述 (最多2个)
│ 促销信息，引导用户点击。                  │
│ [附加链接1] [附加链接2] [附加链接3]       │ ← 附加信息
│ 📞 400-xxx-xxxx                          │ ← 电话扩展
└─────────────────────────────────────────┘
```

### 动态搜索广告 (DSA)

```
传统搜索广告: 广告主手动设置关键词和创意
动态搜索广告: 平台自动匹配网站内容和用户搜索

流程:
  1. 广告主提供网站 URL
  2. 平台爬取网站内容
  3. 用户搜索时，自动匹配相关页面
  4. 自动生成广告标题和落地页 URL

优势: 覆盖长尾搜索词，减少人工管理成本
```

### 响应式搜索广告 (RSA)

```
广告主提供:
  标题: 最多 15 个标题
  描述: 最多 4 个描述

平台自动:
  根据用户搜索词，选择最佳标题+描述组合
  类似 DCO (动态创意优化)
```

---

## 搜索广告的特殊场景

### 品牌词保护

```
问题: 竞品购买你的品牌关键词
  用户搜索 "品牌A" → 展示 "品牌B" 的广告

应对:
  1. 购买自己的品牌词 (通常 CPC 很低)
  2. 品牌词投诉 (部分平台支持)
  3. 提高品牌词的质量分
```

### 本地搜索广告

```
用户搜索 "附近的咖啡店"
  → 展示本地商户广告
  → 包含距离、评分、营业时间
  → 支持导航、电话拨打

Google: Local Search Ads (Google Maps)
百度: 本地推广
```

### 购物广告 (Shopping Ads)

```
用户搜索 "Nike Air Max"
  ┌──────┐ ┌──────┐ ┌──────┐
  │ 商品图│ │ 商品图│ │ 商品图│
  │ ¥899 │ │ ¥799 │ │ ¥949 │
  │ 店铺A │ │ 店铺B │ │ 店铺C │
  └──────┘ └──────┘ └──────┘

数据来源: 商品 Feed (标题、价格、图片、库存)
匹配方式: Query → 商品 Feed 语义匹配
```

---

## 与大数据开发的关联

- **搜索日志处理**: 海量搜索 Query 日志的采集和分析
- **关键词挖掘**: 从搜索日志中挖掘高价值关键词
- **Query 理解数据**: 意图分类、实体识别的训练数据
- **相关性标注数据**: 人工标注的相关性数据管理
- **质量分计算**: 历史 CTR、落地页质量等数据的计算
- **竞价日志分析**: 竞价过程的详细日志分析
- **商品 Feed 管理**: 购物广告的商品数据管道

---

## 面试高频问题

1. 搜索广告的核心流程是什么？
2. 关键词匹配类型有哪些？各自的特点？
3. 质量分是什么？如何影响排名和扣费？
4. GSP 竞价机制是如何工作的？
5. 搜索广告和信息流广告的核心区别？
6. Query 理解包含哪些技术？

---

## 推荐阅读

- 《计算广告》第 14 章 — 搜索广告
- [Google Ads 搜索广告指南](https://ads.google.com/)
- [百度营销帮助中心](https://yingxiao.baidu.com/)
- [DSSM 论文](https://www.microsoft.com/en-us/research/publication/learning-deep-structured-semantic-models-for-web-search-using-clickthrough-data/) — Microsoft, 2013
